{"ast":null,"code":"var _jsxFileName = \"D:\\\\funix\\\\NJS301x_1.0-A_VN L\\u1EADp tr\\xECnh Web Back-End v\\u1EDBi NodeJS\\\\assignment 02\\\\Frontend Assignemnt 02 Admin App\\\\src\\\\components\\\\auth\\\\Login.jsx\",\n    _s = $RefreshSig$();\n\nimport { useState } from \"react\";\nimport './auth.css';\nimport { useDispatch } from \"react-redux\";\nimport { useNavigate } from \"react-router-dom\";\nimport { authActions } from \"../../hook/auth\";\nimport { currentUser, saveToStorage } from \"../../hook/lib\";\nimport { useAPI } from \"../../store/APIContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Login = pros => {\n  _s();\n\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [errorUsername, setErrorUsername] = useState('');\n  const [errorPassword, setErrorPassword] = useState('');\n  const [isErrorUsername, setIsErrorUsername] = useState(false);\n  const [isErrorPassword, setIsErrorPassword] = useState(false);\n  const {\n    users\n  } = useAPI(); // console.log(users);\n\n  const dispatch = useDispatch();\n  const navigate = useNavigate();\n\n  const onChangeUsername = e => {\n    setUsername(e.target.value);\n  };\n\n  const onChangePassword = e => {\n    setPassword(e.target.value);\n  };\n\n  const loginHandler = e => {\n    e.preventDefault(); // console.log(username);\n\n    setIsErrorUsername(false);\n    setIsErrorPassword(false);\n\n    if (!username) {\n      setIsErrorUsername(true);\n      setErrorUsername('username is empty');\n    } else {\n      setIsErrorUsername(false);\n    }\n\n    if (password.trim() === '') {\n      setIsErrorPassword(true);\n      setErrorPassword('password is empty');\n    } else {\n      setErrorUsername(false);\n    }\n\n    const isUserAdmin = users.filter(i => i.username.includes(username))[0].isAdmin;\n    const filteredUser = users.filter(i => i.username.includes(username))[0];\n\n    if (isErrorUsername === true || isErrorPassword === true) {\n      return;\n    }\n\n    if (!isErrorUsername && !isErrorPassword) {\n      if (!users.map(i => i.username).includes(username)) {\n        setIsErrorUsername(true);\n        setErrorUsername(username + ' does not exist');\n        return;\n      } else if (!isUserAdmin) {\n        setIsErrorUsername(true);\n        setErrorUsername(username + ' is not admin');\n        return;\n      } else if (isUserAdmin && filteredUser.password === password) {\n        dispatch(authActions.login());\n\n        while (currentUser.length > 0) {\n          currentUser.pop();\n        }\n\n        ;\n        currentUser.push(filteredUser);\n        saveToStorage('currentUser', currentUser); // console.log(currentUser);\n      }\n\n      ;\n    }\n\n    ;\n    navigate('/home');\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"main\", {\n      className: \"centered\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Login\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"form-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"username\",\n          className: \"form-control\",\n          value: username,\n          onChange: onChangeUsername\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 9\n        }, this), isErrorUsername && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: \"red\",\n            marginBottom: \"1rem\"\n          },\n          children: errorUsername\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          placeholder: \"password\",\n          className: \"form-control\",\n          value: password,\n          onChange: onChangePassword\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 9\n        }, this), isErrorPassword && /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: \"red\",\n            marginBottom: \"1rem\"\n          },\n          children: errorPassword\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 30\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"btn\",\n          onClick: loginHandler,\n          children: \"Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 5\n    }, this)\n  }, void 0, false);\n};\n\n_s(Login, \"dwkbk49SUi5fMKGF98OCmBl8aGw=\", false, function () {\n  return [useAPI, useDispatch, useNavigate];\n});\n\n_c = Login;\nexport default Login;\n\nvar _c;\n\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"sources":["D:/funix/NJS301x_1.0-A_VN Lập trình Web Back-End với NodeJS/assignment 02/Frontend Assignemnt 02 Admin App/src/components/auth/Login.jsx"],"names":["useState","useDispatch","useNavigate","authActions","currentUser","saveToStorage","useAPI","Login","pros","username","setUsername","password","setPassword","errorUsername","setErrorUsername","errorPassword","setErrorPassword","isErrorUsername","setIsErrorUsername","isErrorPassword","setIsErrorPassword","users","dispatch","navigate","onChangeUsername","e","target","value","onChangePassword","loginHandler","preventDefault","trim","isUserAdmin","filter","i","includes","isAdmin","filteredUser","map","login","length","pop","push","color","marginBottom"],"mappings":";;;AAAA,SAASA,QAAT,QAAyB,OAAzB;AACA,OAAO,YAAP;AACA,SAASC,WAAT,QAA4B,aAA5B;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,WAAT,QAA4B,iBAA5B;AACA,SAASC,WAAT,EAAsBC,aAAtB,QAA2C,gBAA3C;AACA,SAASC,MAAT,QAAuB,wBAAvB;;;;AAEA,MAAMC,KAAK,GAAIC,IAAD,IAAU;AAAA;;AACtB,QAAM,CAACC,QAAD,EAAWC,WAAX,IAA0BV,QAAQ,CAAC,EAAD,CAAxC;AACA,QAAM,CAACW,QAAD,EAAWC,WAAX,IAA0BZ,QAAQ,CAAC,EAAD,CAAxC;AAEA,QAAM,CAACa,aAAD,EAAgBC,gBAAhB,IAAoCd,QAAQ,CAAC,EAAD,CAAlD;AACA,QAAM,CAACe,aAAD,EAAgBC,gBAAhB,IAAoChB,QAAQ,CAAC,EAAD,CAAlD;AAEA,QAAM,CAACiB,eAAD,EAAkBC,kBAAlB,IAAwClB,QAAQ,CAAC,KAAD,CAAtD;AACA,QAAM,CAACmB,eAAD,EAAkBC,kBAAlB,IAAwCpB,QAAQ,CAAC,KAAD,CAAtD;AAEA,QAAM;AAAEqB,IAAAA;AAAF,MAAYf,MAAM,EAAxB,CAVsB,CAYtB;;AAEA,QAAMgB,QAAQ,GAAGrB,WAAW,EAA5B;AAEA,QAAMsB,QAAQ,GAAGrB,WAAW,EAA5B;;AAEA,QAAMsB,gBAAgB,GAAIC,CAAD,IAAO;AAC9Bf,IAAAA,WAAW,CAACe,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX;AACD,GAFD;;AAIA,QAAMC,gBAAgB,GAAIH,CAAD,IAAO;AAC9Bb,IAAAA,WAAW,CAACa,CAAC,CAACC,MAAF,CAASC,KAAV,CAAX;AACD,GAFD;;AAIA,QAAME,YAAY,GAAIJ,CAAD,IAAO;AAC1BA,IAAAA,CAAC,CAACK,cAAF,GAD0B,CAG1B;;AAEAZ,IAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACAE,IAAAA,kBAAkB,CAAC,KAAD,CAAlB;;AAEA,QAAG,CAACX,QAAJ,EAAc;AACZS,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAJ,MAAAA,gBAAgB,CAAC,mBAAD,CAAhB;AACD,KAHD,MAGO;AACLI,MAAAA,kBAAkB,CAAC,KAAD,CAAlB;AACD;;AAED,QAAGP,QAAQ,CAACoB,IAAT,OAAoB,EAAvB,EAA2B;AACzBX,MAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAJ,MAAAA,gBAAgB,CAAC,mBAAD,CAAhB;AACD,KAHD,MAGO;AACLF,MAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACD;;AAED,UAAMkB,WAAW,GAAGX,KAAK,CAACY,MAAN,CAAaC,CAAC,IAAIA,CAAC,CAACzB,QAAF,CAAW0B,QAAX,CAAoB1B,QAApB,CAAlB,EAAiD,CAAjD,EAAoD2B,OAAxE;AACA,UAAMC,YAAY,GAAGhB,KAAK,CAACY,MAAN,CAAaC,CAAC,IAAIA,CAAC,CAACzB,QAAF,CAAW0B,QAAX,CAAoB1B,QAApB,CAAlB,EAAiD,CAAjD,CAArB;;AAEA,QAAGQ,eAAe,KAAK,IAApB,IAA4BE,eAAe,KAAK,IAAnD,EAAyD;AACvD;AACD;;AAED,QAAG,CAACF,eAAD,IAAoB,CAACE,eAAxB,EAAyC;AACvC,UAAG,CAACE,KAAK,CAACiB,GAAN,CAAUJ,CAAC,IAAIA,CAAC,CAACzB,QAAjB,EAA2B0B,QAA3B,CAAoC1B,QAApC,CAAJ,EAAmD;AACjDS,QAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAJ,QAAAA,gBAAgB,CAACL,QAAQ,GAAG,iBAAZ,CAAhB;AACA;AACD,OAJD,MAIO,IAAG,CAACuB,WAAJ,EAAiB;AACtBd,QAAAA,kBAAkB,CAAC,IAAD,CAAlB;AACAJ,QAAAA,gBAAgB,CAACL,QAAQ,GAAG,eAAZ,CAAhB;AACA;AACD,OAJM,MAIA,IACHuB,WAAW,IACXK,YAAY,CAAC1B,QAAb,KAA0BA,QAFvB,EAGH;AACFW,QAAAA,QAAQ,CAACnB,WAAW,CAACoC,KAAZ,EAAD,CAAR;;AACA,eAAMnC,WAAW,CAACoC,MAAZ,GAAqB,CAA3B,EAA8B;AAC5BpC,UAAAA,WAAW,CAACqC,GAAZ;AACD;;AAAA;AACDrC,QAAAA,WAAW,CAACsC,IAAZ,CAAiBL,YAAjB;AACAhC,QAAAA,aAAa,CAAC,aAAD,EAAgBD,WAAhB,CAAb,CANE,CAOF;AACD;;AAAA;AACF;;AAAA;AAEDmB,IAAAA,QAAQ,CAAC,OAAD,CAAR;AACD,GArDD;;AAsDA,sBAAO;AAAA,2BACL;AAAM,MAAA,SAAS,EAAC,UAAhB;AAAA,8BACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAEE;AAAM,QAAA,SAAS,EAAC,YAAhB;AAAA,gCACE;AACE,UAAA,IAAI,EAAC,MADP;AAEE,UAAA,WAAW,EAAC,UAFd;AAGE,UAAA,SAAS,EAAC,cAHZ;AAIE,UAAA,KAAK,EAAEd,QAJT;AAKE,UAAA,QAAQ,EAAEe;AALZ;AAAA;AAAA;AAAA;AAAA,gBADF,EAQGP,eAAe,iBAAK;AAAM,UAAA,KAAK,EAAE;AAAE0B,YAAAA,KAAK,EAAE,KAAT;AAAgBC,YAAAA,YAAY,EAAE;AAA9B,WAAb;AAAA,oBAAsD/B;AAAtD;AAAA;AAAA;AAAA;AAAA,gBARvB,eASE;AACE,UAAA,IAAI,EAAC,UADP;AAEE,UAAA,WAAW,EAAC,UAFd;AAGE,UAAA,SAAS,EAAC,cAHZ;AAIE,UAAA,KAAK,EAAEF,QAJT;AAKE,UAAA,QAAQ,EAAEiB;AALZ;AAAA;AAAA;AAAA;AAAA,gBATF,EAgBGT,eAAe,iBAAK;AAAM,UAAA,KAAK,EAAE;AAAEwB,YAAAA,KAAK,EAAE,KAAT;AAAgBC,YAAAA,YAAY,EAAE;AAA9B,WAAb;AAAA,oBAAsD7B;AAAtD;AAAA;AAAA;AAAA;AAAA,gBAhBvB,eAiBE;AACE,UAAA,IAAI,EAAC,QADP;AAEE,UAAA,SAAS,EAAC,KAFZ;AAGE,UAAA,OAAO,EAAEc,YAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAjBF;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADK,mBAAP;AA4BD,CA5GD;;GAAMtB,K;UAUcD,M,EAIDL,W,EAEAC,W;;;KAhBbK,K;AA8GN,eAAeA,KAAf","sourcesContent":["import { useState } from \"react\";\r\nimport './auth.css'\r\nimport { useDispatch } from \"react-redux\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { authActions } from \"../../hook/auth\";\r\nimport { currentUser, saveToStorage } from \"../../hook/lib\";\r\nimport { useAPI } from \"../../store/APIContext\";\r\n\r\nconst Login = (pros) => {\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n\r\n  const [errorUsername, setErrorUsername] = useState('');\r\n  const [errorPassword, setErrorPassword] = useState('');\r\n\r\n  const [isErrorUsername, setIsErrorUsername] = useState(false);\r\n  const [isErrorPassword, setIsErrorPassword] = useState(false);\r\n\r\n  const { users } = useAPI();\r\n\r\n  // console.log(users);\r\n \r\n  const dispatch = useDispatch();\r\n\r\n  const navigate = useNavigate();\r\n\r\n  const onChangeUsername = (e) => {\r\n    setUsername(e.target.value);\r\n  };\r\n\r\n  const onChangePassword = (e) => {\r\n    setPassword(e.target.value);\r\n  };\r\n\r\n  const loginHandler = (e) => {\r\n    e.preventDefault();\r\n\r\n    // console.log(username);\r\n\r\n    setIsErrorUsername(false);\r\n    setIsErrorPassword(false);\r\n\r\n    if(!username) {\r\n      setIsErrorUsername(true);\r\n      setErrorUsername('username is empty');\r\n    } else {\r\n      setIsErrorUsername(false);\r\n    }\r\n\r\n    if(password.trim() === '') {\r\n      setIsErrorPassword(true);\r\n      setErrorPassword('password is empty');\r\n    } else {\r\n      setErrorUsername(false);\r\n    }\r\n\r\n    const isUserAdmin = users.filter(i => i.username.includes(username))[0].isAdmin;\r\n    const filteredUser = users.filter(i => i.username.includes(username))[0];\r\n    \r\n    if(isErrorUsername === true || isErrorPassword === true) {\r\n      return;\r\n    }\r\n\r\n    if(!isErrorUsername && !isErrorPassword) {\r\n      if(!users.map(i => i.username).includes(username)) {\r\n        setIsErrorUsername(true);\r\n        setErrorUsername(username + ' does not exist');\r\n        return;\r\n      } else if(!isUserAdmin) {\r\n        setIsErrorUsername(true);\r\n        setErrorUsername(username + ' is not admin');\r\n        return;\r\n      } else if(\r\n          isUserAdmin &&\r\n          filteredUser.password === password \r\n        ) {\r\n        dispatch(authActions.login());\r\n        while(currentUser.length > 0) {\r\n          currentUser.pop();\r\n        };\r\n        currentUser.push(filteredUser);\r\n        saveToStorage('currentUser', currentUser);\r\n        // console.log(currentUser);\r\n      };\r\n    };\r\n\r\n    navigate('/home');\r\n  };\r\n  return <>\r\n    <main className=\"centered\">\r\n      <h1>Login</h1>\r\n      <form className=\"form-group\">\r\n        <input \r\n          type=\"text\" \r\n          placeholder=\"username\" \r\n          className=\"form-control\" \r\n          value={username}\r\n          onChange={onChangeUsername}\r\n        />\r\n        {isErrorUsername && (<span style={{ color: \"red\", marginBottom: \"1rem\" }}>{errorUsername}</span>)}\r\n        <input \r\n          type=\"password\" \r\n          placeholder=\"password\" \r\n          className=\"form-control\" \r\n          value={password}\r\n          onChange={onChangePassword}\r\n        />\r\n        {isErrorPassword && (<span style={{ color: \"red\", marginBottom: \"1rem\" }}>{errorPassword}</span>)}\r\n        <button \r\n          type=\"submit\" \r\n          className=\"btn\"\r\n          onClick={loginHandler}\r\n        >Login</button>\r\n      </form>\r\n    </main>\r\n  </>\r\n}\r\n\r\nexport default Login;"]},"metadata":{},"sourceType":"module"}