{"ast":null,"code":"var _jsxFileName = \"D:\\\\funix\\\\NJS301x_1.0-A_VN L\\u1EADp tr\\xECnh Web Back-End v\\u1EDBi NodeJS\\\\assignment 03\\\\Frontend Assignemnt 03 Admin App\\\\src\\\\components\\\\chatList\\\\ChatList.jsx\",\n    _s = $RefreshSig$();\n\nimport { useEffect, useState } from 'react';\nimport ChatRoomsAPI from '../../API/ChatRoomsAPI';\nimport './ChatList.css';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io('http://54.254.177.24:5000', {\n  transports: ['websocket']\n});\n\nconst ChatList = () => {\n  _s();\n\n  const [textMessage, setTextMessage] = useState('');\n  const [message, setMessage] = useState();\n  const [roomId, setRoomId] = useState('');\n  const cookieId = document.cookie.split('=')[1];\n  const [load, setLoad] = useState(false); //Sau đó nó emit dữ liệu lên server bằng socket với key send_message và value data\n  // Check if text equal \"/end\" then end room\n\n  if (roomId && textMessage.toLowerCase().trim() === '/end') {\n    ChatRoomsAPI.addMessage({\n      message: \"==END ROOM==\",\n      roomId: roomId,\n      // is_admin: false,\n      cookieId: cookieId\n    }).then(data => {\n      setTextMessage('');\n      setRoomId('');\n      setMessage([]);\n    });\n    return;\n  }\n\n  console.log(roomId); //\n\n  const data = {\n    message: textMessage,\n    roomId: roomId,\n    // is_admin: false,\n    cookieId: cookieId\n  }; //Tiếp theo nó sẽ postdata lên api đưa dữ liệu vào database\n\n  if (roomId && textMessage.trim() !== '') {\n    ChatRoomsAPI.addMessage(data).then(data => {\n      setTextMessage('');\n      setTimeout(() => {\n        setLoad(true);\n        socket.emit('send_message', data);\n      }, 200);\n    });\n  }\n\n  const fetchData = async () => {\n    const response = await ChatRoomsAPI.getMessageByRoomId(roomId);\n    console.log(response);\n    setMessage(response.content);\n  }; // Hàm này dùng để load dữ liệu message của user khi user gửi tin nhán\n\n\n  useEffect(() => {\n    if (load) {\n      fetchData();\n      setLoad(false);\n    }\n  }, [load]);\n  useEffect(() => {\n    setLoad(true);\n  }, [roomId]); //Hàm này dùng để nhận socket từ server gửi lên\n\n  useEffect(() => {\n    //Nhận dữ liệu từ server gửi lên thông qua socket với key receive_message\n    socket.on('receive_message', data => {\n      //Sau đó nó sẽ setLoad gọi lại hàm useEffect lấy lại dữ liệu\n      setLoad(true);\n    });\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ps-container ps-theme-default ps-active-y fix_scoll\",\n    children: message && message.map((value, index) => index === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"media media-chat\",\n      style: {\n        display: 'none'\n      },\n      children: [' ', /*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"avatar\",\n        src: \"https://img.icons8.com/color/36/000000/administrator-male.png\",\n        alt: \"...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 15\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"media-body\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: value.message + index\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 17\n        }, this)\n      }, value.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 15\n      }, this)]\n    }, value._id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }, this) : !value.is_admin ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"media media-chat media-chat-reverse\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"media-body\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"You: \", value.message]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 19\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this)\n    }, value._id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 15\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"media media-chat\",\n      children: [' ', /*#__PURE__*/_jsxDEV(\"img\", {\n        className: \"avatar\",\n        src: \"https://img.icons8.com/color/36/000000/administrator-male.png\",\n        alt: \"...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"media-body\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"C\\u1ED9ng t\\xE1c vi\\xEAn: \", value.message]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 19\n        }, this)\n      }, value.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 17\n      }, this)]\n    }, value._id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 15\n    }, this))\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ChatList, \"Xdp4jWgyu5RFAQs+MFG4D6qHkvc=\");\n\n_c = ChatList;\nexport default ChatList;\n\nvar _c;\n\n$RefreshReg$(_c, \"ChatList\");","map":{"version":3,"sources":["D:/funix/NJS301x_1.0-A_VN Lập trình Web Back-End với NodeJS/assignment 03/Frontend Assignemnt 03 Admin App/src/components/chatList/ChatList.jsx"],"names":["useEffect","useState","ChatRoomsAPI","io","socket","transports","ChatList","textMessage","setTextMessage","message","setMessage","roomId","setRoomId","cookieId","document","cookie","split","load","setLoad","toLowerCase","trim","addMessage","then","data","console","log","setTimeout","emit","fetchData","response","getMessageByRoomId","content","on","map","value","index","display","id","_id","is_admin"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\r\nimport ChatRoomsAPI from '../../API/ChatRoomsAPI';\r\nimport './ChatList.css';\r\n\r\nimport io from 'socket.io-client';\r\nconst socket = io('http://54.254.177.24:5000', { transports : ['websocket']});\r\n\r\nconst ChatList = () => {\r\n  const [textMessage, setTextMessage] = useState('');\r\n  const [message, setMessage] = useState();\r\n  const [roomId, setRoomId] = useState('');\r\n  const cookieId = document.cookie.split('=')[1];\r\n  const [load, setLoad] = useState(false);\r\n  //Sau đó nó emit dữ liệu lên server bằng socket với key send_message và value data\r\n  \r\n  // Check if text equal \"/end\" then end room\r\n  if(roomId && textMessage.toLowerCase().trim() === '/end') {\r\n    ChatRoomsAPI.addMessage({\r\n      message: \"==END ROOM==\",\r\n      roomId: roomId,\r\n      // is_admin: false,\r\n      cookieId: cookieId\r\n    })\r\n    .then(data => {\r\n      setTextMessage('');\r\n      setRoomId('');\r\n      setMessage([]);\r\n    })\r\n    return;\r\n  }\r\n\r\n  console.log(roomId);\r\n\r\n  //\r\n  const data = {\r\n    message: textMessage,\r\n    roomId: roomId,\r\n    // is_admin: false,\r\n    cookieId: cookieId\r\n  };\r\n\r\n  //Tiếp theo nó sẽ postdata lên api đưa dữ liệu vào database\r\n  if(roomId && textMessage.trim() !== '') {\r\n    ChatRoomsAPI.addMessage(data)\r\n    .then(data => {\r\n      setTextMessage('');\r\n      \r\n      setTimeout(() => {\r\n        setLoad(true);\r\n        socket.emit('send_message', data);\r\n      }, 200);\r\n    })\r\n  }\r\n\r\n  const fetchData = async () => {\r\n\t\tconst response = await ChatRoomsAPI.getMessageByRoomId(roomId);\r\n\t\tconsole.log(response);\r\n\t\tsetMessage(response.content);\r\n\t};\r\n\r\n\t// Hàm này dùng để load dữ liệu message của user khi user gửi tin nhán\r\n\tuseEffect(() => {\r\n\t\tif (load) {\r\n\t\t\tfetchData();\r\n\t\t\tsetLoad(false);\r\n\t\t}\r\n\t}, [load]);\r\n\r\n\r\n\tuseEffect(() => {\r\n\t\tsetLoad(true);\r\n\t}, [roomId])\r\n\r\n\t//Hàm này dùng để nhận socket từ server gửi lên\r\n\tuseEffect(() => {\r\n\t\t//Nhận dữ liệu từ server gửi lên thông qua socket với key receive_message\r\n\t\tsocket.on('receive_message', (data) => {\r\n\t\t\t//Sau đó nó sẽ setLoad gọi lại hàm useEffect lấy lại dữ liệu\r\n\t\t\tsetLoad(true);\r\n\t\t});\r\n\t}, []);\r\n\r\n  return (\r\n    <div className='ps-container ps-theme-default ps-active-y fix_scoll'>\r\n      {message &&\r\n        message.map((value, index) =>\r\n          index === 0 ? (\r\n            <div\r\n              className='media media-chat'\r\n              style={{ display: 'none' }}\r\n              key={value._id}>\r\n              {' '}\r\n              <img\r\n                className='avatar'\r\n                src='https://img.icons8.com/color/36/000000/administrator-male.png'\r\n                alt='...'\r\n              />\r\n              <div className='media-body' key={value.id}>\r\n                <p>{value.message + index}</p>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            !value.is_admin ? (\r\n              <div\r\n                className='media media-chat media-chat-reverse'\r\n                key={value._id}>\r\n                <div className='media-body'>\r\n                  <p>You: {value.message}</p>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <div\r\n                className='media media-chat'\r\n                key={value._id}>\r\n                {' '}\r\n                <img\r\n                  className='avatar'\r\n                  src='https://img.icons8.com/color/36/000000/administrator-male.png'\r\n                  alt='...'\r\n                />\r\n                <div className='media-body' key={value.id}>\r\n                  <p>Cộng tác viên: {value.message}</p>\r\n                </div>\r\n              </div>\r\n            )\r\n          )\r\n        )}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ChatList;"]},"metadata":{},"sourceType":"module"}